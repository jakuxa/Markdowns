## 图床服务搭建

### 第一步：安装docker和compose（容器的编排工具）

```shell
yum install docker-latest
curl -L "https://github.com/docker/compose/releases/download/1.23.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/resource/docker-compose
chmod +x /usr/resource/docker-compose
```



#### 更换docker镜像

```shell
# 修改或新增
vim /etc/docker/daemon.json

# {
# "registry-mirrors": ["https://pee6w651.mirror.aliyuncs.com"]
# }

# 或者 [docker中国官方]https://registry.docker-cn.com  [网易]http://hub-mirror.c.163.com  [中国科技大学]https://docker.mirrors.ustc.edu.cn

systemctl restart docker-latest.service
```



### 第二步：获取mariadb和nmtan/chevereto镜像

```shell
systemctl start docker-latest.service
docker pull mariadb:latest
docker pull nmtan/chevereto:latest
```



### 第三步：使用Docker-compose启动服务。

```shell
mkdir cheverto/
cd cheverto
touch docker-compose.yaml
```



### 第四步：在docker-compose.yaml 增加如下内容

```yaml
version: '3'

services:
  db:
    image: mariadb
    volumes:
      - database:/var/lib/mysql:rw
    restart: always
    networks:
      - private
    environment:
      MYSQL_ROOT_PASSWORD: chevereto_root
      MYSQL_DATABASE: chevereto
      MYSQL_USER: chevereto
      MYSQL_PASSWORD: chevereto

  chevereto:
    depends_on:
      - db
    image: nmtan/chevereto
    restart: always
    networks:
      - private
    environment:
      CHEVERETO_DB_HOST: db
      CHEVERETO_DB_USERNAME: chevereto
      CHEVERETO_DB_PASSWORD: chevereto
      CHEVERETO_DB_NAME: chevereto
      CHEVERETO_DB_PREFIX: chv_
    volumes:
      - chevereto_images:/var/www/html/images:rw
    ports:
      - 8888:80

networks:
  private:
volumes:
  database:
  chevereto_images:
```



### 编辑配置文件之后，就能方便的启动服务

```shell
nohup docker-compose up  &> run.log &
disown
```

